<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">IEEE 754 Floating-Point Types in C++ | Kibeom Kim</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="IEEE 754 Floating-Point Types in C++ | Kibeom Kim"><meta data-rh="true" name="description" content="If you want to use IEEE 754 32-bit or 64-bit floating-point types in C++, you might think of using float and double. Unfortunately, the C++ standard offers very few guarantees about its built-in floating-point types."><meta data-rh="true" property="og:description" content="If you want to use IEEE 754 32-bit or 64-bit floating-point types in C++, you might think of using float and double. Unfortunately, the C++ standard offers very few guarantees about its built-in floating-point types."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-06-15T00:00:00.000Z"><meta data-rh="true" property="article:author" content="/"><link data-rh="true" rel="canonical" href="https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++"><link data-rh="true" rel="alternate" href="https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++" hreflang="en"><link data-rh="true" rel="alternate" href="https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++","mainEntityOfPage":"https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++","url":"https://kkimdev.github.io/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++","headline":"IEEE 754 Floating-Point Types in C++","name":"IEEE 754 Floating-Point Types in C++","description":"If you want to use IEEE 754 32-bit or 64-bit floating-point types in C++, you might think of using float and double. Unfortunately, the C++ standard offers very few guarantees about its built-in floating-point types.","datePublished":"2018-06-15T00:00:00.000Z","author":{"@type":"Person","name":"Kibeom Kim","url":"/","image":"https://github.com/kkimdev.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://kkimdev.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kibeom Kim RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kibeom Kim Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RY9P3YLZJ1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RY9P3YLZJ1",{anonymize_ip:!0})</script>




<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto%20Mono"><link rel="stylesheet" href="/assets/css/styles.26556da0.css">
<script src="/assets/js/runtime~main.c0b5726c.js" defer="defer"></script>
<script src="/assets/js/main.afc31426.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="https://github.com/kkimdev.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_HLd7" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Kibeom Kim&#x27;s Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_k5YO colorModeToggle_kzyk"><button class="clean-btn toggleButton_iYsp toggleButtonDisabled_V_0o" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_b06o lightToggleIcon_Z_lD"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_b06o darkToggleIcon_EApx"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_b06o systemToggleIcon_ewKK"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_dFOU"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_zgir"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_NT9c thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_EnTb margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_LEuf">2019</h3><ul class="sidebarItemList_u9Cg clean-list"><li class="sidebarItem_zXUf"><a class="sidebarItemLink_FRoi" href="/blog/2019/04/22/Rust-Compile-Time-Memory-Safety">Rust - Compile-Time Memory Safety</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_LEuf">2018</h3><ul class="sidebarItemList_u9Cg clean-list"><li class="sidebarItem_zXUf"><a aria-current="page" class="sidebarItemLink_FRoi sidebarItemLinkActive_m3jN" href="/blog/2018/06/15/IEEE-754-Floating-Point-Type-in-C++">IEEE 754 Floating-Point Types in C++</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_aCrY">IEEE 754 Floating-Point Types in C++</h1><div class="container_qTaG margin-vert--md"><time datetime="2018-06-15T00:00:00.000Z">June 15, 2018</time> Â· <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_o1NY"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/"><img class="avatar__photo authorImage_cMSJ" src="https://github.com/kkimdev.png" alt="Kibeom Kim"></a><div class="avatar__intro authorDetails_yaY3"><div class="avatar__name"><a href="/"><span class="authorName_ASDy" translate="no">Kibeom Kim</span></a></div><div class="authorSocials_dC04"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>If you want to use IEEE 754 32-bit or 64-bit floating-point types in C++, you might think of using <code>float</code> and <code>double</code>. Unfortunately, the C++ standard offers very few guarantees about its built-in floating-point types.</p>
<blockquote>
<p><a href="http://eel.is/c++draft/basic.fundamental#8" target="_blank" rel="noopener noreferrer" class="">Â§ 6.7.1.8</a> There are three
floating-point types: float, double, and long double. The type double provides
at least as much precision as float, and the type long double provides at
least as much precision as double. The set of values of the type float is a
subset of the set of values of the type double; the set of values of the type
double is a subset of the set of values of the type long double. <strong>The value
representation of floating-point types is implementation-defined</strong>. ...</p>
</blockquote>
<p>So, are we doomed? Not at all. C++ provides <a href="http://en.cppreference.com/w/cpp/types/numeric_limits" target="_blank" rel="noopener noreferrer" class=""><code>std::numeric_limits</code></a>, which gives us information about floating-point type traits. We can combine this with some neat compile-time tricks to craft a clean type API. Let&#x27;s see how. The goal is to construct the following IEEE 754 floating-point types:</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(0, 0, 255)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(163, 21, 21)">&lt;iostream&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(0, 0, 255)">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(163, 21, 21)">&quot;ieee754_types.hpp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  IEEE_754_2008_Binary</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  IEEE_754_2008_Binary</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2.0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Compile-time error if the requested type doesn&#x27;t exist on the system.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// IEEE_754_2008_Binary&lt;16&gt; z;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre></div></div>
<p>Here, <code>IEEE_754_2008_Binary&lt;n&gt;</code> is an n-bit IEEE 754 floating-point type. On most systems, <code>IEEE_754_2008_Binary&lt;32&gt;</code> will be <code>float</code> and <code>IEEE_754_2008_Binary&lt;64&gt;</code> will be <code>double</code>. If a requested type like <code>IEEE_754_2008_Binary&lt;16&gt;</code> is not available, we should get a compile-time error with a clear message.</p>
<p>At this point, you might naturally ask, &quot;Do we really need this? Can&#x27;t we just assume <code>float</code> and <code>double</code> are IEEE 754, since they are on 99.9% of systems?&quot; I used to think so, but I later found that others have submitted related proposals, like <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1703.pdf" target="_blank" rel="noopener noreferrer" class="">N1703</a> and <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3626.pdf" target="_blank" rel="noopener noreferrer" class="">N3626</a>, to the C and C++ standards committees to address this issue by adding standard types like <code>float16_t</code>, <code>float32_t</code>, <code>float64_t</code>, and <code>float128_t</code>. So, perhaps this effort isn&#x27;t entirely pointless. With that, let&#x27;s get started.</p>
<p>First, let&#x27;s create a way to check if a given type <code>T</code> fulfills the IEEE 754 standard and our other conditions.</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> exponent_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> mantissa_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Is_Ieee754_2008_Binary_Interchange_Format</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token plain"> value </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token generic-function function" style="color:rgb(0, 0, 255)">is_floating_point</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">is_iec559      </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">radix </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">     </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">get_storage_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> storage_bits    </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">get_exponent_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> exponent_bits  </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">get_mantissa_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> mantissa_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre></div></div>
<p>We use a <a href="https://en.cppreference.com/w/cpp/language/variable_template" target="_blank" rel="noopener noreferrer" class="">variable template</a> for the type-dependent boolean check and wrap it in a template <code>struct</code>. This makes it easy to pass around as a type template parameter later.</p>
<p>First, we check if <code>T</code> complies with IEEE 754 (equivalently, <a href="https://www.iso.org/standard/57469.html" target="_blank" rel="noopener noreferrer" class="">IEC 60559</a>) using <a href="https://en.cppreference.com/w/cpp/types/numeric_limits/is_iec559" target="_blank" rel="noopener noreferrer" class=""><code>std::numeric_limits&lt;T&gt;::is_iec559</code></a>. We also check <code>radix == 2</code> because IEEE 754 defines two types of floating-point numbers: binary and decimal. Finally, we check if <code>T</code> has the requested number of storage (width), exponent, and mantissa bits. Although IEEE 754 defines a standard number of exponent and mantissa bits for certain sizes (16, 32, 64, 128, etc.), it also allows implementations to have arbitrary sizes and bit counts (e.g., the <a href="https://en.wikipedia.org/wiki/Extended_precision#x86_extended_precision_format" target="_blank" rel="noopener noreferrer" class="">x86 extended precision format</a>). Therefore, we need to check that <code>T</code> has the exact format we want.</p>
<p>We can calculate the number of bits for <code>T</code> with the following simple compile-time functions:</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">get_storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">sizeof</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> CHAR_BIT</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">get_exponent_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> exponent_range </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">max_exponent </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                       </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">min_exponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> bits </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">exponent_range </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"> bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">++</span><span class="token plain">bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">get_mantissa_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">digits </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre></div></div>
<p>For the mantissa bits, <code>std::numeric_limits&lt;T&gt;::digits</code> includes the implicit leading bit for normalized numbers, so we subtract 1 to get the number of explicit mantissa bits. For the exponent bits, a direct property is not available in <code>std::numeric_limits</code>, so we instead calculate the minimum number of bits required to represent its exponent range.</p>
<p>Now we have everything needed to determine if a given <code>T</code> is the type we&#x27;re looking for. The next step is to automatically select such a type from the built-in floating-point types (<code>float</code>, <code>double</code>, and <code>long double</code>), given a size in bits (e.g., 32, 64). This is where it gets interesting.</p>
<p>The following recursive function, <code>find_type()</code>, selects a type from <code>T</code> and <code>Ts...</code> that satisfies the condition <code>C</code>.</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Ts</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">auto</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">find_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">throw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">C</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">sizeof</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">Ts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">find_type</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">C</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> Ts</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre></div></div>
<p>In our case, the types to search (<code>T</code> and <code>Ts...</code>) will be <code>float</code>, <code>double</code>, and <code>long double</code>. The condition <code>C</code> is the <code>Is_Ieee754_2008_Binary_Interchange_Format&lt;...&gt;</code> struct we defined previously.</p>
<p><code>typename... Ts</code> is a <a href="https://en.cppreference.com/w/cpp/language/parameter_pack" target="_blank" rel="noopener noreferrer" class="">parameter pack</a> that can match any number of types. The first <code>if</code> condition, <code>C::template value&lt;T&gt;</code>, checks if <code>T</code> satisfies the condition <code>C</code>; if so, it returns a default-constructed instance of <code>T</code>. The second <code>if</code> condition, <code>sizeof...(Ts) &gt;= 1</code>, checks if there are more types in <code>Ts...</code> to examine; if so, it recursively calls <code>find_type()</code> with <code>Ts...</code> to continue the search. Finally, if <code>Ts...</code> is empty, it returns <code>void()</code>.</p>
<p>Since the return type of <code>find_type()</code> is <code>auto</code>, the compiler will deduce the return type at compile time from the <code>return</code> statement in the branch that is taken. Additionally, <a href="http://en.cppreference.com/w/cpp/language/if#Constexpr_If" target="_blank" rel="noopener noreferrer" class=""><code>if constexpr</code></a> discards the unused conditional paths at compile time, so <code>find_type()</code> compiles successfully even though it has multiple <code>return</code> statements with different types.</p>
<p>Since <code>find_type()</code>&#x27;s return type is what we need, we can use <code>decltype(find_type&lt;...&gt;())</code> to get the resulting type. The <code>throw;</code> statement on the first line of <code>find_type()</code> is not strictly necessary, but it&#x27;s there to indicate that <code>find_type()</code> is not meant to be called at runtime.</p>
<p>The following code defines a <code>BinaryFloatOrVoid</code> type alias using <code>decltype(find_type&lt;...&gt;())</code>. This new type will be an IEEE 754 floating-point type that matches the given storage, exponent, and mantissa bits, or it will be <code>void</code> if the search fails.</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> exponent_bits </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">standard_binary_interchange_format_exponent_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">storage_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> mantissa_bits </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">standard_binary_interchange_format_mantissa_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">storage_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> BinaryFloatOrVoid </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">decltype</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">find_type</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">                                                </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             Is_Ieee754_2008_Binary_Interchange_Format</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                       exponent_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                                       mantissa_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">             </span><span class="token keyword" style="color:rgb(0, 0, 255)">float</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">long</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre></div></div>
<p>The functions <code>standard_binary_interchange_format_exponent_bits()</code> and <code>standard_binary_interchange_format_mantissa_bits()</code> return the standard number of exponent and mantissa bits, respectively. We set them as default values for <code>exponent_bits</code> and <code>mantissa_bits</code> for convenience. I will omit their implementations, as they are straightforward.</p>
<p>Before <code>if constexpr</code> was added in C++17, this kind of compile-time type manipulation was typically implemented with <a href="https://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error" target="_blank" rel="noopener noreferrer" class="">SFINAE</a>. The following code shows how this can be done using that approach:</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// Recursion termination: Type not found.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Ts</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">FindType</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Recursion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Ts</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">FindType</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> Ts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Set `type = T` if T satisfies condition C; otherwise, keep</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// searching in the remaining types, Ts...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">conditional_t</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      C</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">FindType</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">C</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> Ts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> exponent_bits </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">standard_binary_interchange_format_exponent_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">storage_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> mantissa_bits </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">standard_binary_interchange_format_mantissa_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">storage_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> BinaryFloatOrVoid </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">FindType</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">                  </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Is_Ieee754_2008_Binary_Interchange_Format</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">   </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                              exponent_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                                              mantissa_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">float</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">long</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">double</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre></div></div>
<p>Clearly, the <code>if constexpr</code> version is simpler and much more readable. I expect to see less of the &quot;SFINAE mess&quot; in the future, thanks to <code>if constexpr</code> and, hopefully, <a href="https://en.wikipedia.org/wiki/Concepts_(C%2B%2B)" target="_blank" rel="noopener noreferrer" class="">concepts</a>.</p>
<p>Finally, we introduce another type layer to produce a compile-time error with a clear message if the requested type is not available (i.e., <code>BinaryFloatOrVoid</code> is <code>void</code>).</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">AssertTypeFound</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">is_same_v</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;No corresponding IEEE 754-2008 binary interchange format found.&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> storage_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> IEEE_754_2008_Binary </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">AssertTypeFound</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    BinaryFloatOrVoid</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">storage_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre></div></div>
<p>OK, we have finally constructed the type <code>IEEE_754_2008_Binary&lt;n&gt;</code> that guarantees conformance to the IEEE 754 standard binary interchange format. Yay!</p>
<p>So are we done? Not quite. There&#x27;s one last step that every programmer loves: writing tests. :)</p>
<div class="language-cpp codeBlockContainer_JH_B theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_cFO2"><pre tabindex="0" class="prism-code language-cpp codeBlock_z2x2 thin-scrollbar" style="color:#000000;background-color:#ffffff"><code class="codeBlockLines_RwTv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> exponent_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token plain"> mantissa_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">test_if_type_exists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">throw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">constexpr</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">is_same_v</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">BinaryFloatOrVoid</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">storage_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">using</span><span class="token plain"> T </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> IEEE_754_2008_Binary</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">storage_bits</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token generic-function function" style="color:rgb(0, 0, 255)">is_floating_point</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">is_iec559</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">numeric_limits</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token double-colon punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token plain">radix </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token generic-function function" style="color:rgb(0, 0, 255)">get_storage_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> storage_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token generic-function function" style="color:rgb(0, 0, 255)">get_exponent_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> exponent_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">static_assert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token generic-function function" style="color:rgb(0, 0, 255)">get_mantissa_bits</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">T</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> mantissa_bits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">tests</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">throw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">test_if_type_exists</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">16</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">5</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">10</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">test_if_type_exists</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">32</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">8</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">23</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">test_if_type_exists</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">64</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">11</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">52</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">test_if_type_exists</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">128</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">15</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name number" style="color:rgb(9, 134, 88)">112</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre></div></div>
<p>Again, all the checks are done at compile time with <code>static_assert</code>, so we don&#x27;t need to call <code>tests()</code>. We just have to ensure that the <code>test_if_type_exists</code> functions are instantiated. If a type doesn&#x27;t exist (e.g., 16- and 128-bit types on most systems), then <code>if constexpr</code> will simply discard the checks.</p>
<p>I hope you had as much fun reading this as I did writing it. The full implementation is available in this repository: <a href="https://github.com/kkimdev/ieee754-types" target="_blank" rel="noopener noreferrer" class="">https://github.com/kkimdev/ieee754-types</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2019/04/22/Rust-Compile-Time-Memory-Safety"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Rust - Compile-Time Memory Safety</div></a></nav></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Kibeom Kim</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/@kkimdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_YyBE"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/kkimdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_YyBE"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/kkimdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_YyBE"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/kkimdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_YyBE"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:kk1674@nyu.edu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_YyBE"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Kibeom Kim</div></div></div></footer></div>
</body>
</html>